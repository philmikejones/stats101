

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Comparing three or more means &mdash; stats101 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Comparing two independent groups" href="11-comparing-two-independent-groups.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> stats101
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01-introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="01-introduction.html#Inferring-from-a-sample">Inferring from a sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="01-introduction.html#Types-of-samples">Types of samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="01-introduction.html#Description-and-inference">Description and inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="01-introduction.html#Units-of-observation">Units of observation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="02-data-sources.html">Data sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-levels-of-measurement.html">Levels of measurement</a><ul>
<li class="toctree-l2"><a class="reference internal" href="03-levels-of-measurement.html#Nominal">Nominal</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-levels-of-measurement.html#Ordinal">Ordinal</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-levels-of-measurement.html#Interval">Interval</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-levels-of-measurement.html#Ratio">Ratio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="03-levels-of-measurement.html#Discrete-and-continuous-data">Discrete and continuous data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="04-central-tendency.html">Central tendency</a><ul>
<li class="toctree-l2"><a class="reference internal" href="04-central-tendency.html#Mode">Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-central-tendency.html#Median">Median</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-central-tendency.html#Mean">Mean</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="05-measures-of-spread.html">Measures of spread</a><ul>
<li class="toctree-l2"><a class="reference internal" href="05-measures-of-spread.html#Range">Range</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-measures-of-spread.html#Inter–quartile-range">Inter–quartile range</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-measures-of-spread.html#Variance">Variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-measures-of-spread.html#Standard-deviation">Standard deviation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="06-standard-error-confidence-intervals.html">Standard error and confidence intervals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="06-standard-error-confidence-intervals.html#Comparing-means-and-confidence-intervals">Comparing means and confidence intervals</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="07-normal-distribution.html">Normal distribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="07-normal-distribution.html#Skewness">Skewness</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-normal-distribution.html#Kurtosis">Kurtosis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="08-hypothesis-testing.html">Hypothesis testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="08-hypothesis-testing.html#Null-hypothesis">Null hypothesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="08-hypothesis-testing.html#Errors-interpreting-the-results">Errors interpreting the results</a></li>
<li class="toctree-l2"><a class="reference internal" href="08-hypothesis-testing.html#Directional-tests">Directional tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="09-chi-squared-test.html">Chi–squared test</a><ul>
<li class="toctree-l2"><a class="reference internal" href="09-chi-squared-test.html#Test-statistic">Test statistic</a></li>
<li class="toctree-l2"><a class="reference internal" href="09-chi-squared-test.html#Degrees-of-freedom">Degrees of freedom</a></li>
<li class="toctree-l2"><a class="reference internal" href="09-chi-squared-test.html#p-value"><em>p</em> value</a></li>
<li class="toctree-l2"><a class="reference internal" href="09-chi-squared-test.html#Assumptions">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="09-chi-squared-test.html#Odds-ratio">Odds ratio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="10-correlation.html">Correlation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="10-correlation.html#Pearson’s-correlation-coefficient,-r">Pearson’s correlation coefficient, <span class="math notranslate nohighlight">\(r\)</span></a><ul>
<li class="toctree-l3"><a class="reference internal" href="10-correlation.html#Assumptions">Assumptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="10-correlation.html#Spearman’s-\rho">Spearman’s <span class="math notranslate nohighlight">\(\rho\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="10-correlation.html#Kendall’s-\tau">Kendall’s <span class="math notranslate nohighlight">\(\tau\)</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="11-comparing-two-independent-groups.html">Comparing two independent groups</a><ul>
<li class="toctree-l2"><a class="reference internal" href="11-comparing-two-independent-groups.html#t–test"><span class="math notranslate nohighlight">\(t\)</span>–test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="11-comparing-two-independent-groups.html#Assumptions">Assumptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="11-comparing-two-independent-groups.html#Mann–Whitney-U">Mann–Whitney U</a></li>
<li class="toctree-l2"><a class="reference internal" href="11-comparing-two-independent-groups.html#Dependent-groups">Dependent groups</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Comparing three or more means</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Assumptions">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Equality-of-variance">Equality of variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ANOVA">ANOVA</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stats101</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Comparing three or more means</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/12-comparing-three-or-more-means.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Comparing-three-or-more-means">
<h1>Comparing three or more means<a class="headerlink" href="#Comparing-three-or-more-means" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">import</span> <span class="nn">statsmodels.stats.multicomp</span>

<span class="n">age_shf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;../data/processed/age_shf&quot;</span><span class="p">)</span>
<span class="n">age_ebn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;../data/processed/age_ebn&quot;</span><span class="p">)</span>
<span class="n">age_oxf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;../data/processed/age_oxf&quot;</span><span class="p">)</span>

<span class="c1"># we want just a sample; a population is more likely to be statistically significant!</span>
<span class="n">age_shf</span> <span class="o">=</span> <span class="n">age_shf</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
<span class="n">age_ebn</span> <span class="o">=</span> <span class="n">age_ebn</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
<span class="n">age_oxf</span> <span class="o">=</span> <span class="n">age_oxf</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In the previous section we compared the means of two different groups to see if they were statistically significantly different. Specifically we tested to see if the mean age of residents of Eastbourne is greater than the mean age of residents of Sheffield, and it was. This suggests that, overall, the population of Eastbourne is older than the population of Sheffield, and so there might be some truth to the caricature that Eastbourne is a popular retirement destination.</p>
<p>But what if we want to compare the means of more than two groups? Could we perform multiple <span class="math notranslate nohighlight">\(t\)</span>–tests? Well, no. It has been argued that the process of performing multiple <span class="math notranslate nohighlight">\(t\)</span>–tests is laborious because you need to perform one for each pair of means. These days, with the automation provided by computers, we no longer need to do the tests manually so this is no longer relevant; performing multiple <span class="math notranslate nohighlight">\(t\)</span>–tests in a loop is now a trivial task with <code class="docutils literal notranslate"><span class="pre">R</span></code> or <code class="docutils literal notranslate"><span class="pre">Python</span></code>.</p>
<p>But, there’s a more important reason we shouldn’t perform multiple <span class="math notranslate nohighlight">\(t\)</span>–tests, even though we can. By performing multiple <span class="math notranslate nohighlight">\(t\)</span>–tests we increase the risk of making a <a class="reference external" href="08-hypothesis-testing.html#Errors-interpreting-the-results">Type I error</a>. Remember we can never <em>prove</em> things with statistics, only calculate how likely something is to happen by chance alone.</p>
<p>By convention we use a threshold of 0.05, or less than a 5% chance that the results we observe are by chance. But at 5% there’s a 1 in 20 chance we commit a Type I error. So if we performed 20 pairs of <span class="math notranslate nohighlight">\(t\)</span>–tests we would be almost guaranteed to make at least one Type I error! XKCD, as always, neatly sums this up.</p>
<p><img alt="Significant" src="https://imgs.xkcd.com/comics/significant.png" /></p>
<p>So instead of making multiple <span class="math notranslate nohighlight">\(t\)</span>–tests we perform an analysis of variance (ANOVA).</p>
<div class="section" id="Example">
<h2>Example<a class="headerlink" href="#Example" title="Permalink to this headline">¶</a></h2>
<p>For this example I use the ages of a sample of 1,000 people from Sheffield and Eastbourne as before, but to compare an additional mean I include a sample of 1,000 people from Oxford. Oxford is one of the youngest populations overall for any city in the UK, perhaps because of the student population, so this test will see if there is a difference between the ages of Oxford, Sheffield, and Eastbourne. Our null hypothesis (<span class="math notranslate nohighlight">\(H_0\)</span>) is therefore that there is no statistically significant
difference between the mean ages of residents in Oxford, Sheffield, and Eastbourne.</p>
</div>
<div class="section" id="Assumptions">
<h2>Assumptions<a class="headerlink" href="#Assumptions" title="Permalink to this headline">¶</a></h2>
<p>The assumptions of ANOVA are, not surprisingly, very similar to those of a <span class="math notranslate nohighlight">\(t\)</span>–test:</p>
<ul class="simple">
<li>Measurements/observations are independent of each other (i.e.&nbsp;from different people)</li>
<li>Measurements are on a continuous scale</li>
<li>If the sample size is small the variables should have a normal distribution.</li>
</ul>
<p>For our example the observations are independent (the ages of people in Sheffield do not affect the ages of people in Eastbourne or Oxford). Age is a continuous measure (even though it’s measured here on a discrete scale we can treat it as continuous). We have sample sizes of 1,000 per group so do not need to check for normality, but if we did we would plot a series of <a class="reference external" href="11-comparing-two-independent-groups.html#Assumptions">QQ plots</a> as we did for <span class="math notranslate nohighlight">\(t\)</span>–tests.</p>
</div>
<div class="section" id="Equality-of-variance">
<h2>Equality of variance<a class="headerlink" href="#Equality-of-variance" title="Permalink to this headline">¶</a></h2>
<p>As with the <span class="math notranslate nohighlight">\(t\)</span>–test it is ideal if the variances of the three (or more) groups are equal, so we are looking for <em>equality of variance</em>. However, as a rule of thumb <a class="reference external" href="https://stats.stackexchange.com/a/56994/35674">ANOVA is robust to differences in variance of up to 4x</a>. That is, if the largest variance is no larger than 4x the smallest variance the ANOVA is still reliable.</p>
<p>First, let’s try a Levene test for equality of variance as we might not even need to worry about this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">levene</span><span class="p">(</span>
    <span class="n">age_oxf</span><span class="o">.</span><span class="n">C_AGE_NAME</span><span class="p">,</span> <span class="n">age_shf</span><span class="o">.</span><span class="n">C_AGE_NAME</span><span class="p">,</span> <span class="n">age_ebn</span><span class="o">.</span><span class="n">C_AGE_NAME</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>LeveneResult(statistic=18.98095012875844, pvalue=6.43352435595419e-09)
</pre></div>
</div>
</div>
<p>Here the Levene statistic is statistically significant (<span class="math notranslate nohighlight">\(p &lt;&lt; 0.01\)</span>) so we must reject the null that there is no difference between the variances, and assume that the variances are not equal. So is the largest variance less than 4x the smallest variance?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">max_var</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">age_shf</span><span class="o">.</span><span class="n">C_AGE_NAME</span><span class="o">.</span><span class="n">var</span><span class="p">(),</span> <span class="n">age_ebn</span><span class="o">.</span><span class="n">C_AGE_NAME</span><span class="o">.</span><span class="n">var</span><span class="p">(),</span> <span class="n">age_oxf</span><span class="o">.</span><span class="n">C_AGE_NAME</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
<span class="n">min_var</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">age_shf</span><span class="o">.</span><span class="n">C_AGE_NAME</span><span class="o">.</span><span class="n">var</span><span class="p">(),</span> <span class="n">age_ebn</span><span class="o">.</span><span class="n">C_AGE_NAME</span><span class="o">.</span><span class="n">var</span><span class="p">(),</span> <span class="n">age_oxf</span><span class="o">.</span><span class="n">C_AGE_NAME</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_var</span> <span class="o">/</span> <span class="n">min_var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.3360587582810752
</pre></div></div>
</div>
<p>The maximum variance is therefore less than twice as large as the minimum variance, so our rule of thumb holds for this data set and we can interpret the ANOVA as reliable.</p>
</div>
<div class="section" id="ANOVA">
<h2>ANOVA<a class="headerlink" href="#ANOVA" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">f_oneway</span><span class="p">(</span>
    <span class="n">age_shf</span><span class="p">,</span> <span class="n">age_ebn</span><span class="p">,</span> <span class="n">age_oxf</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>F_onewayResult(statistic=array([27.76084434]), pvalue=array([1.13223062e-12]))
</pre></div>
</div>
</div>
<p>The ANOVA result is statistically significant (<span class="math notranslate nohighlight">\(p &lt;&lt; 0.01\)</span>) so there is a statistically significant difference between the mean ages of people in Sheffield, Eastbourne, and Oxford overall. Now let’s run some post–hoc tests to see which group(s) actually differ. First we should transform the data into ‘long’ form, so one row per obvservation. So that we know which observation is from which city I add a ‘<code class="docutils literal notranslate"><span class="pre">city</span></code>’ variable:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">age_shf</span> <span class="o">=</span> <span class="n">age_shf</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">city</span> <span class="o">=</span> <span class="s2">&quot;Sheffield&quot;</span><span class="p">)</span>
<span class="n">age_ebn</span> <span class="o">=</span> <span class="n">age_ebn</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">city</span> <span class="o">=</span> <span class="s2">&quot;Eastbourne&quot;</span><span class="p">)</span>
<span class="n">age_oxf</span> <span class="o">=</span> <span class="n">age_oxf</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">city</span> <span class="o">=</span> <span class="s2">&quot;Oxford&quot;</span><span class="p">)</span>
<span class="n">ages</span> <span class="o">=</span> <span class="n">age_shf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">age_ebn</span><span class="p">)</span>
<span class="n">ages</span> <span class="o">=</span> <span class="n">ages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">age_oxf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now the post–hoc tests:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">posthoc</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">multicomp</span><span class="o">.</span><span class="n">MultiComparison</span><span class="p">(</span>
    <span class="n">ages</span><span class="o">.</span><span class="n">C_AGE_NAME</span><span class="p">,</span> <span class="n">ages</span><span class="o">.</span><span class="n">city</span>
<span class="p">)</span>

<span class="n">posthoc</span> <span class="o">=</span> <span class="n">posthoc</span><span class="o">.</span><span class="n">tukeyhsd</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">posthoc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 Multiple Comparison of Means - Tukey HSD,FWER=0.05
====================================================
  group1     group2  meandiff  lower   upper  reject
----------------------------------------------------
Eastbourne   Oxford   -7.542  -9.9761 -5.1079  True
Eastbourne Sheffield  -5.257  -7.6911 -2.8229  True
  Oxford   Sheffield  2.285   -0.1491  4.7191 False
----------------------------------------------------
</pre></div></div>
</div>
<p>The post–hoc tests suggest that there is a difference in ages between people in Oxford and Eastbourne, and Sheffield and Eastbourne, but <em>not</em> between Oxford and Sheffield. This would indicate that people in Eastbourne are older, on average, than people in Oxford or in Sheffield, but that people in Oxford are not younger than people in Sheffield overall.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="11-comparing-two-independent-groups.html" class="btn btn-neutral" title="Comparing two independent groups" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Phil Mike Jones

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>